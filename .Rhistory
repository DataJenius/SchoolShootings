combined.xts["2018-02-14"]
plot.combined.xts <- combined.xts["1950/2019", c("diMA25yr","diMA10yr","diMA5yr")]
chart.TimeSeries(plot.combined.xts,
colorset = c("darkorange","darkred","darkblue"),
main = "Combined Deaths & Injuries per Year, Rolling Average",
lwd = 2,
legend.loc = "topleft")
# plot the xts of MA of incidents since 1950
plot.combined.xts <- combined.xts["1950/2019", c("diMA25yr","diMA10yr","diMA5yr")]
chart.TimeSeries(plot.combined.xts,
colorset = c("darkorange","darkred","darkblue"),
main = "Deaths & Injuries per Incident, Rolling Average",
lwd = 2,
legend.loc = "topleft")
head(combined.xts)
head(wiki.df)
max(wiki.df$injuries)
jojo <- wiki.df[,c('deaths',"injuries")]
jojo$combined <- jojo$deaths+jojo$injuries
jojo
jojo[order(jojo$combined),]
head(jojo[order(jojo$combined),],n=20)
head(jojo[-order(jojo$combined),],n=20)
head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo[order(jojo$year),]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=15)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=15)
jojo[order(jojo$year),]
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950 & jojo$combined >= 15,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),])
jojo[order(jojo$year),]
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950 & jojo$combined >= 15,]
head(jojo[order(jojo$combined,decreasing = TRUE),])
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),n=20])
jojo[order(jojo$year),]
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),n=20)
jojo[order(jojo$year),]
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),n=20)
jojo[order(jojo$year),]
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined)) +
geom_box()
ggplot(jojo, aes(x=date,y=combined)) +
geom_bar(stat="identity")
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity")
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab(label) +
ylab("Deaths & Injuries per Incident") +
labs( title = title,
subtitle = "All school shootings: July 26, 1764 through March 2, 2018"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab(label) +
ylab("Deaths & Injuries per Incident") +
labs( title = "title",
subtitle = "All school shootings: July 26, 1764 through March 2, 2018"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# let's unpack it further and graph the most horrible events - quick and dirty here
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=20)
jojo <- jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Worst 20 Incidents Since 1950") +
ylab("Combined Deaths & Injuries per Incident") +
labs( title = "title",
subtitle = "Worst 20 shootings: January 1, 1950 through March 2, 2018"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# let's unpack it further and graph the most horrible events - quick and dirty here
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=50)
jojo <- jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Worst 20 Incidents Since 1950") +
ylab("Combined Deaths & Injuries per Incident") +
labs( title = "The 20 Worst School Shootings since 1950",
subtitle = "The Worst 20 School shootings: January 1, 1950 through March 2, 2018"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# let's unpack it further and graph the most horrible events - quick and dirty here
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=25)
jojo <- jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Worst 20 Incidents Since 1950") +
ylab("Combined Deaths & Injuries per Incident") +
guides(fill=guide_legend(title="Year")) +
labs( title = "The 25 Worst School Shootings since 1950",
subtitle = "School shootings with the most combined injuries and deaths"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# let's unpack it further and graph the most horrible events - quick and dirty here
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=25)
jojo <- jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Date of Incident") +
ylab("Combined Deaths & Injuries") +
guides(fill=guide_legend(title="Year")) +
labs( title = "The 25 Worst School Shootings since 1950",
subtitle = "School shootings with the most combined injuries and deaths"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# let's unpack it further and graph the most horrible events - quick and dirty here
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=25)
jojo <- jojo[order(jojo$year),]
ggplot(jojo, aes(x=date,y=combined, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Date of Incident") +
ylab("Combined Deaths & Injuries") +
guides(fill=guide_legend(title="Year")) +
labs( title = "The 25 Worst School Shootings since 1950",
subtitle = "School shootings with the most combined deaths and injuries"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
head(incidents.xts)
head(wiki.xts)
jojo <- wiki.xts["1950/2019",c("combined")]
head(jojo)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
jojo <- jojo[jojo$year >= 1950,]
jojo <- head(jojo[order(jojo$combined,decreasing = TRUE),],n=25)
jojo <- jojo[order(jojo$year),]
head(jojo,n=25)
head(jojo[order(jojo$combined),])
jojo <- wiki.xts["1950/2019",c("combined")]
jojo <- jojo[jojo$combined >= 10]
nrow(jojo)
jojo
jojo <- wiki.xts["1950/2019",c("combined")]
jojo <- jojo[jojo$combined >= 10]
chart.TimeSeries(jojo)
jojo <- wiki.df
head(jojo)
jojo <- wiki.df
jojo$combined <- jojo$deaths+jojo$injuries
head(jojo)
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
head(jojo)
mean(jojo$combined)
head(jojo)
jojo$under4 <- ifelse(jojo$combined < 4,1,0)
head(jojo)
jojo$under3 <- ifelse(jojo$combined < 3,1,0)
head(jojo)
jojo$under2 <- ifelse(jojo$combined < 2,1,0)
head(jojo)
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$under2 <- ifelse(jojo$combined < 2,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(per=mean(under2))
bobo
# % of incidents with 0 combined?
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$under2 <- ifelse(jojo$combined < 2,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(under2),
nono = n(),
per=mean(under2))
bobo
# % of incidents with 0 combined?
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$under <- ifelse(jojo$combined < 3,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(under),
nono = n(),
per=mean(under))
bobo
# % of incidents with 0 combined?
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$under <- ifelse(jojo$combined < 10,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(under),
nono = n(),
per=mean(under))
bobo
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$extreme <- ifelse(jojo$combined >= 10,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(extreme),
all = n(),
per=mean(extreme))
bobo
jojo <- bobo$per*100
head(jojo)
jojo <- bobo[,c("per")]*100
head(jojo)
jojo <- bobo[,c("per")]*100
head(jojo)
jojo <- bobo[,c("per","decade")]
head(jojo)
ggplot(jojo, aes(x=decade,y=per, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Date of Incident") +
ylab("Combined Deaths & Injuries") +
guides(fill=guide_legend(title="Year")) +
labs( title = "The 25 Worst School Shootings since 1950",
subtitle = "School shootings with the most combined deaths and injuries"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# % of incidents with at least 10 combined?
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$extreme <- ifelse(jojo$combined >= 10,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(extreme),
all = n(),
per=mean(extreme))
jojo <- bobo[,c("per","decade")]
ggplot(jojo, aes(x=decade,y=per, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Date of Incident") +
scale_y_continuous("Combined Deaths & Injuries", labels = scales::percent) +
guides(fill=guide_legend(title="Year")) +
labs( title = "The 25 Worst School Shootings since 1950",
subtitle = "School shootings with the most combined deaths and injuries"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
# % of incidents with at least 10 combined?
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$extreme <- ifelse(jojo$combined >= 10,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
count = sum(extreme),
all = n(),
per=mean(extreme))
jojo <- bobo[,c("per","decade")]
ggplot(jojo, aes(x=decade,y=per, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Decade") +
scale_y_continuous("Incidents with 10+ Deaths & Injuries", labels = scales::percent) +
guides(fill=guide_legend(title="Year")) +
labs( title = "Relative Frequency of Extreme Events",
subtitle = "School shootings with the most combined deaths and injuries"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
ggplot(jojo, aes(x=decade,y=per, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Decade") +
scale_y_continuous("Incidents with 10+ Deaths & Injuries", labels = scales::percent) +
guides(fill=guide_legend(title="Year")) +
labs( title = "Relative Frequency of Extreme Events",
subtitle = "Extreme events as a percentage of all school shootings by decade"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
ggplot(jojo, aes(x=decade,y=per, fill=decade)) +
geom_bar(stat="identity") +
theme(axis.text.x = element_text(angle = 90, hjust = 1)) +
xlab("Decade") +
scale_y_continuous("Incidents with 10+ Deaths & Injuries", labels = scales::percent) +
guides(fill=guide_legend(title="Year")) +
labs( title = "Relative Frequency of Extreme Incidents",
subtitle = "Extreme incidents as a percentage of all school shootings by decade"
) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
head(jojo)
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
head(jojo)
jojo$combined <- jojo$deaths+jojo$injuries
jojo$extreme.incidents <- ifelse(jojo$combined >= 10,1,0)
head(jojo)
jojo <- wiki.df
jojo <- jojo[jojo$year >= 1950,]
jojo$combined <- jojo$deaths+jojo$injuries
jojo$extreme.incidents <- ifelse(jojo$combined >= 10,1,0)
bobo <- jojo %>%
group_by(decade) %>%
summarize(
incidents = n(),
extreme.incidents = sum(extreme.incidents)
)
bobo
###########################################################################
# Do these scores correlate with school shootings?
# http://lawcenter.giffords.org/scorecard/
scorecard.df <- read.csv("data/Giffords_lawcenter_scorecard_grades_2018_03_04.csv")
# Only look at incidents on after 2000
by.state <- summarize_data_by_feature(wiki.df[wiki.df$year >= 2000,], "state")
# Merge grades with states
state.grades <- merge(by.state, scorecard.df, by = c("state"), all.y = TRUE)
# Set states with no incidents to 0 for accuracy
state.grades[is.na(state.grades$incidents),c("incidents")] <- 0
state.grades[is.na(state.grades$deaths),c("deaths")] <- 0
state.grades[is.na(state.grades$injuries),c("injuries")] <- 0
state.grades[is.na(state.grades$combined),c("combined")] <- 0
# Add population data for each state
# https://en.wikipedia.org/wiki/List_of_U.S._states_and_territories_by_population
pop.df <- read.csv("data/Wikipedia_states_by_population_2018-03-05.csv")
state.grades <- merge(state.grades, pop.df, by = c("state"))
# Add homicide rate data for each state
# https://en.wikipedia.org/wiki/List_of_U.S._states_by_homicide_rate
homicide.df <- read.csv("data/Wikipedia_states_by_homicide_rate_2018-03-05.csv")
state.grades <- merge(state.grades, homicide.df, by = c("state"))
# Assign each letter grade a numeric value for the sake of calculating correlation
state.grades[state.grades$grade=="A",c("grade.score")] <- 9
state.grades[state.grades$grade=="A-",c("grade.score")] <- 8
state.grades[state.grades$grade=="B+",c("grade.score")] <- 7
state.grades[state.grades$grade=="B",c("grade.score")] <- 6
state.grades[state.grades$grade=="C+",c("grade.score")] <- 5
state.grades[state.grades$grade=="C",c("grade.score")] <- 4
state.grades[state.grades$grade=="C-",c("grade.score")] <- 3
state.grades[state.grades$grade=="D",c("grade.score")] <- 2
state.grades[state.grades$grade=="D-",c("grade.score")] <- 1
state.grades[state.grades$grade=="F",c("grade.score")] <- 0
# Group grades into three categories
state.grades[state.grades$grade=="A",c("grade.group")] <- "A-B"
state.grades[state.grades$grade=="A-",c("grade.group")] <- "A-B"
state.grades[state.grades$grade=="B+",c("grade.group")] <- "A-B"
state.grades[state.grades$grade=="B",c("grade.group")] <- "A-B"
state.grades[state.grades$grade=="C+",c("grade.group")] <- "C-D"
state.grades[state.grades$grade=="C",c("grade.group")] <- "C-D"
state.grades[state.grades$grade=="C-",c("grade.group")] <- "C-D"
state.grades[state.grades$grade=="D",c("grade.group")] <- "C-D"
state.grades[state.grades$grade=="D-",c("grade.group")] <- "C-D"
state.grades[state.grades$grade=="F",c("grade.group")] <- "F"
state.grades$grade.group <- as.factor(state.grades$grade.group)
head(state.grades)
###########################################################################
# Now that we've got all our stats let's look at correlation
# The date selected above (1980 or 2000) has no effect on this
cor(state.grades$grade.score,state.grades$homicide.rate, method="spearman")
cor(state.grades$grade.score,state.grades$homicide.rate, method="kendall")
cor(state.grades$grade.score,state.grades$homicide.rate, method="pearson")
# Homicides v Giffords Gun Score: -0.2285 as grade improves
ggplot(state.grades, aes(x=grade.score, y=homicide.rate))+
geom_point() +
ylab("Homicides per 100k population (2016)") +
scale_x_continuous("Giffords Gun Score (2017)", breaks=c(0,2,4,6,9), labels=c("F","D","C","B","A")) +
labs( title = "Homicides v Giffords Gun Score",
subtitle = paste("All 50 States by Score, Pearson Correlation Coeffecient: ",round(cor(state.grades$grade.score,state.grades$homicide.rate, method="pearson"),4), sep="")) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
jojo <- state.grades %>%
group_by(grade.group) %>%
summarise(n=n())
jojo
# Homicides v Giffords Gun Score: Box & Whiskers
ggplot(state.grades, aes(x=grade.group, y=homicide.rate))+
geom_boxplot() +
ylab("Homicides per 100k population (2016)") +
xlab("Giffords Gun Score (2017)") +
labs( title = "Homicides v Giffords Gun Score",
subtitle = "All 50 States by Score, Grouped by Grades") +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
##############################################################################
# Calculate school shooting incidents and d&i per 100,000 general population
# The date selected above (1980 or 2000) has an effect on this
# Some states had no incidents
state.grades[state.grades$incidents==0,c("incidents.per.100k")] <- 0
state.grades[is.na(state.grades$incidents.per.100k),c("incidents.per.100k")] <- state.grades[is.na(state.grades$incidents.per.100k),c("incidents")]/(state.grades[is.na(state.grades$incidents.per.100k),c("population")]/100000)
# Total combined injuries and deaths
state.grades[state.grades$incidents==0,c("combined.per.100k")] <- 0
state.grades[is.na(state.grades$combined.per.100k),c("combined.per.100k")] <- state.grades[is.na(state.grades$combined.per.100k),c("combined")]/(state.grades[is.na(state.grades$combined.per.100k),c("population")]/100000)
state.grades
# Incidents v Giffords Gun Score: -0.3028 as grade improves  (since 1980)
ggplot(state.grades, aes(x=grade.score, y=incidents.per.100k))+
geom_point() +
ylab("Incidents per 100k population (2017)") +
scale_x_continuous("Giffords Gun Score (2017)", breaks=c(0,2,4,6,9), labels=c("F","D","C","B","A")) +
labs( title = "School Shootings (Since 2000) v Giffords Gun Score",
subtitle = paste("All 50 States by Score, Pearson Correlation Coeffecient: ",round(cor(state.grades$grade.score,state.grades$incidents.per.100k, method="pearson"),4), sep="")) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
# Incidents v Giffords Gun Score: Box & Whiskers
ggplot(state.grades, aes(x=grade.group, y=incidents.per.100k))+
geom_boxplot() +
ylab("Incidents per 100k population (2017)") +
xlab("Giffords Gun Score (2017)") +
labs( title = "School Shootings (Since 2000) v Giffords Gun Score",
subtitle = "All 50 States by Score, Grouped by Grades") +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
max(state.grades$incidents)
state.grades[state.grades$incidents=25,]
state.grades[state.grades$incidents==25,]
state.grades[max(state.grades$incidents.per.100k),]
max(state.grades$incidents.per.100k)
state.grades[max(state.grades$incidents.per.100k==0.1603445),]
state.grades[state.grades$incidents.per.100k==0.1603445,]
state.grades[order(state.grades$incidents.per.100k),]
state.grades[45,]
state.grades[state.grades$incidents==0,]
state.grades[state.grades$incidents==0,c('state','grade')]
# D&I v Giffords Gun Score: -0.1113 as grade improves (since 1980)
ggplot(state.grades, aes(x=grade.score, y=combined.per.100k))+
geom_point() +
ylab("Deaths & injuries per 100k population (2017)") +
scale_x_continuous("Giffords Gun Score (2017)", breaks=c(0,2,4,6,9), labels=c("F","D","C","B","A")) +
labs( title = "School Shootings (Since 2000) v Giffords Gun Score",
subtitle = paste("All 50 States by Score, Pearson Correlation Coeffecient: ",round(cor(state.grades$grade.score,state.grades$combined.per.100k, method="pearson"),4), sep="")) +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5)) +
geom_smooth(method='lm')
# D&I v Giffords Gun Score: -0.1113 as grade improves
# We have an outlier - Wyoming - 1986
# https://en.wikipedia.org/wiki/Cokeville_Elementary_School_hostage_crisis
# D&I v Giffords Gun Score: Box & Whiskers
ggplot(state.grades, aes(x=grade.group, y=combined.per.100k))+
geom_boxplot() +
ylab("Deaths & injuries per 100k population (2017)") +
xlab("Giffords Gun Score (2017)") +
labs( title = "School Shootings (Since 2000) v Giffords Gun Score",
subtitle = "All 50 States by Score, Grouped by Grades") +
theme(plot.title = element_text(hjust = 0.5),
plot.subtitle = element_text(hjust = 0.5))
